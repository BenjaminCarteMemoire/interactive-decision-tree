function a(o,e,r="",t="idt_main"){throw c.MAIN_DIV.innerHTML="<div class='IDT_error IDT_error_fatal'>"+e+(r!=""?"<hr>"+r:"")+"</div>",console.error(e,r),new Error("IDT stopped due to a fatal error.")}function _(o){return o.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&")}function d(o,e,r=!1,t="click"){if(r)for(let n=0;n<o.length;n++)o[n].removeEventListener(t,e);else for(let n=0;n<o.length;n++)o[n].addEventListener(t,e,!1)}class l{constructor(e="idt_container",r="idt_main",t="idt_main_frame",n="idt_controls"){if(this.errcode=0,this.SUPER_GLOBAL_DIV=document.getElementById(e),!(this.SUPER_GLOBAL_DIV instanceof HTMLElement)){console.error(`IDT Super global DIV (${e}) not found in the page. Abort.`),this.errcode=-1;return}this.GLOBAL_DIV=document.createElement("div"),this.GLOBAL_DIV.id=r,this.SUPER_GLOBAL_DIV.appendChild(this.GLOBAL_DIV),this.CONTROLS_DIV=document.createElement("div"),this.CONTROLS_DIV.id=n,this.SUPER_GLOBAL_DIV.appendChild(this.CONTROLS_DIV),this.MAIN_DIV=document.createElement("div"),this.MAIN_DIV.id=t,this.GLOBAL_DIV.appendChild(this.MAIN_DIV),this.DIVS={},this.errcode=0}add_custom_div(e,r=!1,t=null){if(typeof this.DIVS>"u")return console.error("IDT Divs is not initialized. Abort."),this.errcode=-2,this.errcode;if(r)this.DIVS[e]=document.createElement("div"),this.DIVS[e].id=e,t==null&&(t=this.GLOBAL_DIV),t?.appendChild(this.DIVS[e]);else if(this.DIVS[e]=document.getElementById(e),typeof this.DIVS[e]===null)return console.error(`Custom DIV (${e}) may not exist. Abort.`),this.errcode=-1,this.errcode;return 0}render(){this.current_node=IDT_TREE[s.current_section()],this.MAIN_DIV.innerHTML="";try{typeof this.current_node.args.title<"u"&&(this.MAIN_DIV.innerHTML+="<span class='IDT_title'>"+this.current_node.args.title+"</span>")}catch(e){a("fatal",`A requested IDT Node doesn't exist. (${s.current_section()}`,e);return}typeof i[this.current_node.type]<"u"&&i[this.current_node.type].render()}}class h{constructor(e="start"){this.prev_section_stack=[],this.goto=(r=null)=>{let t="none",n=IDT_TREE[this.current_section()];typeof i[n.type]<"u"&&(t=i[n.type].prepare_goto(r,t)),this._goto(t)},this.change_section(e)}change_section(e){this.section=e}current_section(){return this.section}_goto(e){this.change_section(e),c.render()}}class I{constructor(e){this.name=e}set_current_node(){this.current_node=IDT_TREE[s.current_section()]}prepare_goto(e,r){return r}}class u extends I{constructor(e="question"){super(e)}render_back_button(e){e.innerHTML+=`<a class="idt_answer" style="
                            --IDT-bgcolor:#555;
                            --IDT-border-color:#444;
                            --IDT-hover-bgcolor:#b3b3b3;
                            --IDT-hover-border-color:#595959;
                        "data-answer-id="-1">Go back</a>`}prepare_goto(e,r){if(d(this.IDT_question_buttons,s.goto,!0),e===null)return r;let t,n=e.target?.getAttribute("data-answer-id")??"-1";return n=="-1"?t=s.prev_section_stack.pop():(s.prev_section_stack.push(s.current_section()),t=this.current_node.answers[n].to),t}render(){this.set_current_node(),c.MAIN_DIV.innerHTML+="<div class='IDT_question'><span class='IDT_question_title'>"+_(this.current_node.text)+"</span><div id='IDT_QA_buttons', class='IDT_question_answers'></div></div>";let e=0,r=document.getElementById("IDT_QA_buttons");if(r===null){a("fatal","IDT Question Answers DIV not found.");return}this.current_node.answers.forEach(t=>{r.innerHTML+=`<a class="idt_answer" style="
                            --IDT-bgcolor:${t.args.color??"inherit"};
                            --IDT-border-color:${t.args["border-color"]??"inherit"};
                            --IDT-hover-bgcolor:${t.args["hover-color"]??"inherit"};
                            --IDT-hover-border-color: ${t.args["hover-border-color"]??"inherit"};
                        "data-answer-id="${e++}">${t.args.title}</a>`}),this.current_node.args.back_button==!0&&this.render_back_button(r),this.IDT_question_buttons=document.getElementsByClassName("idt_answer"),d(this.IDT_question_buttons,s.goto)}}class D extends u{constructor(){super("leaf")}render(){if(this.set_current_node(),c.MAIN_DIV.innerHTML+="<div class='IDT_leaf'><span class='IDT_leaf_text'>"+_(this.current_node.text)+"</span><div id='IDT_QA_buttons' class='IDT_question_answers'></div></div>",this.current_node.args.back_button==!0){let e=document.getElementById("IDT_QA_buttons");e!==null&&this.render_back_button(e)}this.IDT_question_buttons=document.getElementsByClassName("idt_answer"),d(this.IDT_question_buttons,s.goto)}}const i={question:new u,leaf:new D},c=new l,s=new h;document.addEventListener("DOMContentLoaded",function(){function o(){if(typeof IDT_TREE>"u")return console.error("The JSON Tree is not defined. Abort."),-1;s.change_section(IDT_TREE._internal.start??"start"),s._goto(s.current_section())}o()});
